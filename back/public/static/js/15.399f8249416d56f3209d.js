webpackJsonp([15],{"8yI9":function(t,e,s){var a={"./views/deals/buy":"YTMq"};function i(t){return s(n(t))}function n(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}i.keys=function(){return Object.keys(a)},i.resolve=n,t.exports=i,i.id="8yI9"},Kt5j:function(t,e){},"Nw+U":function(t,e,s){"use strict";var a=s("hRKE"),i=s.n(a),n=s("qZvt"),o=s.n(n),r=s("G63U"),l=s("GCtz"),c=(r.a,l.a,String,String,Array,String,String,Boolean,String,Number,Object,Boolean,Array,{name:"selector",mixins:[r.a],created:function(){void 0!==this.value&&(this.currentValue=this.value)},beforeMount:function(){this.isIOS=/iPad|iPhone|iPod/.test(window.navigator.userAgent)},computed:{fixIos:function(){return!this.placeholder&&this.isEmptyValue(this.value)&&this.isIOS&&this.title},color:function(){return this.showPlaceholder?"#A9A9A9":""},processOptions:function(){var t=this;if(!this.options.length)return[];var e="object"===i()(this.options[0]);return e&&!this.valueMap?this.options:e&&this.valueMap?this.options.map(function(e){return{key:e[t.valueMap[0]],value:e[t.valueMap[1]]}}):this.options.map(function(t){return{key:t,value:t}})},showPlaceholder:function(){return!(!this.isEmptyValue(this.value)||!this.placeholder)},labelClass:function(){return{"vux-cell-justify":"justify"===this.$parent.labelAlign||"justify"===this.$parent.$parent.labelAlign}}},methods:{isEmptyValue:function(t){return void 0===t||""===t||null===t},cleanStyle:l.a,getFullValue:function(){var t=this;return this.value&&this.options.length?"object"!==i()(this.options[0])?this.value:this.valueMap?this.options.filter(function(e){return e[t.valueMap[0]]===t.value}):this.options.filter(function(e){return e.key===t.value}):null}},filters:{findByKey:function(t,e){var s=o()(e,function(e){return e.key===t});return s?s.value:t}},watch:{value:function(t){this.currentValue=t},currentValue:function(t){this.$emit("input",t),this.$emit("on-change",t)}},props:{title:String,direction:String,options:{type:Array,required:!0},name:String,placeholder:String,readonly:Boolean,value:[String,Number,Object,Boolean],valueMap:{type:Array,validator:function(t){return!(!t.length||2!==t.length)}}},data:function(){return{currentValue:"",isIOS:!1}}}),u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"vux-selector weui-cell",class:{"weui-cell_select":!t.readonly,"weui-cell_select-after":t.title}},[t.title?s("div",{staticClass:"weui-cell__hd"},[s("label",{staticClass:"weui-label",class:t.labelClass,style:t.cleanStyle({width:t.$parent.labelWidth,textAlign:t.$parent.labelAlign,marginRight:t.$parent.labelMarginRight}),attrs:{for:"vux-selector-"+t.uuid},domProps:{innerHTML:t._s(t.title)}})]):t._e(),t._v(" "),t.readonly?s("div",{staticClass:"weui-cell__ft vux-selector-readonly"},[t._v("\n    "+t._s(t._f("findByKey")(t.value,t.processOptions))+"\n  ")]):s("div",{staticClass:"weui-cell__bd"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"weui-select",style:t.cleanStyle({direction:t.direction,color:t.color}),attrs:{id:"vux-selector-"+t.uuid,name:t.name},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.currentValue=e.target.multiple?s:s[0]}}},[t.showPlaceholder?s("option",{domProps:{value:null===t.value?"null":"",selected:t.isEmptyValue(t.value)&&!!t.placeholder}},[t._v(t._s(t.placeholder))]):t._e(),t._v(" "),t.fixIos?s("option",{attrs:{disabled:""}}):t._e(),t._v(" "),t._l(t.processOptions,function(e){return s("option",{domProps:{value:e.key}},[t._v(t._s(e.value))])})],2)])])},staticRenderFns:[]};var _=s("C7Lr")(c,u,!1,function(t){s("Kt5j")},null,null);e.a=_.exports},PX4w:function(t,e){},YTMq:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("CHv/"),i=s("Kw0a"),n=s("ky06"),o=s("Nw+U"),r=(a.a,i.a,n.a,o.a,{components:{XInput:a.a,PopupPicker:i.a,Group:n.a,Selector:o.a},data:function(){return{timer:null,countimer:"",ifshow:!1,wait:null,minute:null,second:null,add:!1,is_open:!1,sellerName:"",vc_unit_price:0,vc_less_amount:0,total_price:0,amount:0,payment_info:[],chose_payment:"",payment:{},chose_payment_info:{payment_key:""},pay_status:0,order_id:0,confirm_pay:0,buttonName:"未付款视为违规行为，我确认已付款",readOnlyFlag:!1,buy_flag:1,time_end:!1,identity:"",order_sn:"",lock_day:0,click_lock:!1}},mounted:function(){var t=this;if(!this.$route.params.id){if(this.$route.params.otc_order_id){this.order_id=this.$route.params.otc_order_id;var e=this.$route.params.type;return 2==e&&(this.buy_flag=0),this.pay_status=1,this.readOnlyFlag=!0,this.$http.post("/api/app.otc/order",{order_id:this.order_id,type:e}).then(function(s){var a=s.data.order_list[0];if(t.sellerName=a.buyersellername,t.amount=a.vc_amount,t.vc_unit_price=a.vc_uint_price,t.identity=a.identity,t.order_sn=a.order_sn,t.lock_day=a.lock_day,1==e)if(a.status>0)t.confirm_pay=1,t.buttonName="已付款";else{var i=a.create_time_stamp+60*t.$store.state.init.otc_order_overtime-Date.parse(new Date)/1e3;i<0?(t.$vux.toast.text("已超出付款时间"),t.time_end=!0):t.counttime(i)}else if(2==e){var n=a.pay_time_stamp+18e3-Date.parse(new Date)/1e3;n<0?(t.$vux.toast.text("已超出发GBL时间"),t.time_end=!0):t.counttime(n)}t.chose_payment_info=JSON.parse(a.payment_info)}).catch(function(t){}),!1}this.$router.push({path:"/deals/center"})}var s={otc_id:this.$route.params.id};this.$http.post("/api/app.otc/deals",s).then(function(e){if(0==e.errcode){var s=e.data.otc_list[0];if(t.sellerName=s.username,t.vc_unit_price=s.vc_unit_price,t.vc_less_amount=s.vc_less_amount,t.amount=s.vc_less_amount,s.payment){for(var a in s.payment)t.payment_info.push({key:a,value:s.payment[a].payment_org});t.payment=s.payment,t.chose_payment=t.payment_info[0].key}t.lock_day=s.lock_day}else t.$vux.toast.text(e.message)}).catch(function(e){e.errcode&&t.$vux.toast.text(e.message),setTimeout(function(){t.$router.push({path:"/deals/center"})},2e3)})},methods:{counttime:function(t){var e=this;this.countimer=t,this.wait||(this.countimer=t,this.ifshow=!0,this.wait=setInterval(function(){e.countimer>0&&e.countimer<=t?(e.countimer--,e.minute=Math.floor(e.countimer/60),e.second=Math.floor(e.countimer%60),e.minute<=9&&(e.minute="0"+e.minute),e.second<=9&&(e.second="0"+e.second)):(e.ifshow=!1,e.add=!0,clearInterval(e.wait),e.wait=null,e.minute="00",e.second="00")},1e3))},isopen:function(){var t=this;if(0==this.confirm_pay){var e={order_id:this.order_id};this.$http.post("/api/app.otc/deals/confirmpay",e).then(function(e){t.is_open=!0,t.confirm_pay=1,t.buttonName="已付款"}).catch(function(e){e.errcode&&t.$vux.toast.text(e.message)})}else this.is_open=!0},colse_pup:function(){this.is_open=!1},showPayInfo:function(){"string"==typeof this.chose_payment&&(this.chose_payment_info=this.payment[this.chose_payment])},buy:function(){var t=this;if(this.click_lock)return!1;if(this.click_lock=!0,this.vc_less_amount<=this.$store.state.init.min_otc_sale&&this.amount!=this.vc_less_amount)return this.amount=this.vc_less_amount,void this.$vux.toast.text("剩余数量只有"+this.vc_less_amount+"个,必须全部受让");var e={otc_id:this.$route.params.id,amount:this.amount,payment_info:this.chose_payment_info};this.$http.post("/api/app.otc/deals/buy",e).then(function(e){0==e.errcode&&(t.pay_status=1,t.order_id=e.data.order_id,t.readOnlyFlag=!0),t.click_lock=!1,t.pay_status=1,t.counttime(60*t.$store.state.init.otc_order_overtime)}).catch(function(e){t.click_lock=!1,e.errcode&&t.$vux.toast.text(e.message)})},deliver:function(){var t={order_id:this.order_id},e=this;this.$vux.confirm.show({content:"是否确认发GBL",onConfirm:function(){e.$http.post("/api/app.otc/deals/confirmreceive",t).then(function(t){0==t.errcode?(e.$vux.toast.text("已确认发GBL"),setTimeout(function(){e.$router.push({name:"dealsRecord",params:{type:2}})},2e3)):e.$vux.toast.text(t.message)}).catch(function(t){t.errcode&&e.$vux.toast.text(t.message)})}})},checkBuyNum:function(t){return{valid:t>0,msg:"受让数量必须大于0"}},onCopy:function(t){this.$vux.toast.text("复制成功")},onError:function(t){this.$vux.toast.text("复制失败，您可以尝试手动记录")}}}),l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"buy-box"},[s("div",{staticClass:"head"},[t._v("\r\n        您将"),"buyer"==t.identity?s("span",[t._v("受让")]):"seller"==t.identity?s("span",[t._v("出让")]):s("span",[t._v("受让")]),t._v("的"+t._s(t.$store.state.init.coin_uint)+"\r\n    ")]),t._v(" "),s("div",{staticClass:"buy-block"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.pay_status,expression:"pay_status"}],staticClass:"item flex-box vux-1px-b"},[t._m(0),t._v(" "),s("div",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.order_sn,expression:"order_sn",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"decs"},[t._v(t._s(t.order_sn)+" "),s("i",{staticClass:"iconfont"},[t._v("")])])]),t._v(" "),s("div",{staticClass:"item flex-box vux-1px-b"},[s("div",{staticClass:"title flex-1"},["buyer"==t.identity?s("span",[t._v("出让方")]):"seller"==t.identity?s("span",[t._v("受让方")]):s("span",[t._v("出让方")])]),t._v(" "),s("div",{staticClass:"decs"},[t._v(t._s(t.sellerName))])]),t._v(" "),s("div",{staticClass:"item vux-1px-b flex-box"},[s("div",{staticClass:"title flex-1"},[t._v("行情")]),t._v(" "),s("div",{staticClass:"decs"},[s("div",{staticClass:"price-box flex-box"},[s("div",{staticClass:"price"},[t._v("¥ "),s("span",[t._v(t._s((t.amount*t.vc_unit_price).toFixed(2)||0))])]),t._v(" "),s("div",{staticClass:"univalent"},[t._v("单价 ¥ "+t._s(t.vc_unit_price))])])])]),t._v(" "),s("div",{staticClass:"item vux-1px-b flex-box"},[s("div",{staticClass:"title flex-1"},[t._v("数量 "),t.readOnlyFlag?t._e():s("span",[t._v("（可改）")])]),t._v(" "),s("x-input",{attrs:{readonly:t.readOnlyFlag,required:"",placeholder:"请输入受让数量","placeholder-align":"right","text-align":"right",required:!0,"is-type":t.checkBuyNum},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}})],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.payment_info.length>0&&!t.readOnlyFlag,expression:"payment_info.length>0&&!readOnlyFlag"}],staticClass:"item flex-box vux-1px-b"},[s("selector",{staticStyle:{width:"100%"},attrs:{title:"支付方式",options:t.payment_info,direction:"rtl"},on:{"on-change":t.showPayInfo},model:{value:t.chose_payment,callback:function(e){t.chose_payment=e},expression:"chose_payment"}})],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.payment_info.length||t.readOnlyFlag,expression:"payment_info.length==0 || readOnlyFlag"}],staticClass:"item flex-box vux-1px-b"},[s("div",{staticClass:"title flex-1"},[t._v("支付方式")]),t._v(" "),s("div",{staticClass:"decs"},[t._v(t._s(t.chose_payment_info.payment_org))])]),t._v(" "),t.lock_day>0?s("div",{staticClass:"item flex-box vux-1px-b"},[s("div",{staticClass:"title flex-1"},[t._v("锁仓时间")]),t._v(" "),s("div",{staticClass:"decs"},[t._v(t._s(t.lock_day)+"天")])]):t._e(),t._v(" "),t.lock_day>0?s("div",{staticClass:"item flex-box vux-1px-b"},[s("div",{staticClass:"title flex-1"},[t._v("每日释放")]),t._v(" "),s("div",{staticClass:"decs"},[t._v(t._s(t.amount/t.lock_day.toFixed(5)))])]):t._e(),t._v(" "),t._m(1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.pay_status&&"bankcard"==t.chose_payment_info.payment_key,expression:"pay_status==1&&chose_payment_info.payment_key == 'bankcard'"}],staticClass:"item flex-box vux-1px-b"},[s("div",{staticClass:"title flex-1"},[t._v("卡号")]),t._v(" "),s("div",{staticClass:"decs"},[t._v(t._s(t.chose_payment_info.payment_account))])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.pay_status&&"bankcard"==t.chose_payment_info.payment_key,expression:"pay_status==1&&chose_payment_info.payment_key == 'bankcard'"}],staticClass:"item flex-box vux-1px-b"},[s("div",{staticClass:"title flex-1"},[t._v("支行")]),t._v(" "),s("div",{staticClass:"decs"},[t._v(t._s(t.chose_payment_info.branch_bank))])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.pay_status&&"bankcard"==t.chose_payment_info.payment_key,expression:"pay_status==1&&chose_payment_info.payment_key == 'bankcard'"}],staticClass:"item flex-box vux-1px-b"},[s("div",{staticClass:"title flex-1"},[t._v("转入人")]),t._v(" "),s("div",{staticClass:"decs"},[t._v(t._s(t.chose_payment_info.payment_receipt))])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.pay_status,expression:"pay_status==1"}],staticStyle:{"text-align":"center",padding:"20px"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:"weixin"==t.chose_payment_info.payment_key||"alipay"==t.chose_payment_info.payment_key,expression:"chose_payment_info.payment_key=='weixin' || chose_payment_info.payment_key=='alipay'"}]},[s("img",{attrs:{src:t.chose_payment_info.qrcode,height:"200",width:"200"}})])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.buy_flag&&!t.time_end,expression:"buy_flag==1 && !time_end"}]},[s("box",{directives:[{name:"show",rawName:"v-show",value:0==t.pay_status,expression:"pay_status==0"}],attrs:{gap:"8px 35px 25px"}},[s("x-button",{staticClass:"buy-btn",class:{noTime:t.add},staticStyle:{"border-radius":"99px"},attrs:{type:"primary"},nativeOn:{click:function(e){t.buy()}}},[t._v("确认下单")])],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.pay_status,expression:"pay_status==1"}],staticClass:"buy-bottom"},[s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.confirm_pay,expression:"confirm_pay==0"}],staticClass:"tis"},[t._v("请在倒计时时间内完成支付")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.confirm_pay,expression:"confirm_pay==0"}],staticClass:"count-down"},[t._v("\r\n                倒计时 "),s("span",[t._v(t._s(t.minute)+":"+t._s(t.second))])]),t._v(" "),s("box",{attrs:{gap:"8px 35px 25px"}},[s("x-button",{directives:[{name:"show",rawName:"v-show",value:0==t.confirm_pay,expression:"confirm_pay==0"}],staticClass:"buy-btn",class:{noTime:t.add},staticStyle:{"border-radius":"99px"},attrs:{type:"primary"},nativeOn:{click:function(e){t.isopen()}}},[t._v(t._s(t.buttonName))])],1)],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.buy_flag&&!t.time_end,expression:"buy_flag==0 && !time_end"}]},[s("div",{staticClass:"buy-bottom"},[s("div",{staticClass:"tis"},[t._v("转入不发"+t._s(t.$store.state.init.coin_uint)+"将视为严重影响信用值,请在300分钟内完成发"+t._s(t.$store.state.init.coin_uint))]),t._v(" "),s("div",{staticClass:"count-down"},[t._v("\r\n                倒计时 "),s("span",[t._v(t._s(t.minute)+":"+t._s(t.second))])]),t._v(" "),s("box",{attrs:{gap:"8px 35px 25px"}},[s("x-button",{staticClass:"buy-btn",class:{noTime:t.add},staticStyle:{"border-radius":"99px"},attrs:{type:"primary"},nativeOn:{click:function(e){t.deliver()}}},[t._v("我已收到款，确认发GBL")])],1)],1)]),t._v(" "),s("div",{staticClass:"pupBox",class:{isopen:t.is_open}},[s("div",{staticClass:"pupBox-content"},[s("div",{staticClass:"pup-block"},[s("p",[t._v("您受让的"+t._s(t.$store.state.init.coin_uint)+"将在"+t._s(this.$store.state.init.otc_order_overtime)+"分钟内到账，请注意查收。")]),t._v(" "),s("p",[t._v("未付款的请重新付款，否则将影响信用")])]),t._v(" "),s("div",{staticClass:"pup-btn-box flex-box vux-1px-t"},[s("router-link",{staticClass:"pup-btn flex-1 vux-1px-r",attrs:{to:"/deals/record"}},[t._v("没收到,我要申诉")]),t._v(" "),s("div",{staticClass:"pup-btn flex-1 confirm-btn",on:{click:function(e){t.colse_pup()}}},[t._v("知道了")])],1)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title flex-1"},[e("span",[this._v("订单号")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item item-tis flex-box vux-1px-b"},[e("div",{staticClass:"title"},[this._v("注：")]),this._v(" "),e("div",{staticClass:"decs flex-1"},[this._v("此处显示对方的转入方式，任意选择一种方式去付款，未付款不能点击我已确认付款，违规操作信用将受到影响")])])}]};var c=s("C7Lr")(r,l,!1,function(t){s("PX4w")},null,null);e.default=c.exports}});