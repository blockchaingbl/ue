webpackJsonp([68],{ABmE:function(e,t){},"T+/8":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("3cXf"),o=s.n(r),i=s("4YfN"),a=s.n(i),n=s("mAm1"),c=s("NyFS"),l=s("oa6C"),d=s("SPhl"),u=s("sNOJ"),f=s("Kw0a"),p=s("AL98"),h=s("9rMa"),m=(s("xSLg"),n.a,c.a,l.a,p.a,d.a,u.a,f.a,a()({},Object(h.b)(["setToken"]),{getCode:function(){var e=this;this.$refs.mobile.validate(),this.$refs.mobile.valid&&""!=this.form.mobile?this.$http.post("/api/app.util/sms/send",{mobile:this.form.mobile,type:0,mobile_code:parseInt(this.mobile_code)}).then(function(t){e.$vux.toast.text("发送成功"),e.$vux.toast.text(t.message),e.counttime(60)}).catch(function(t){e.$vux.toast.text(t.message),1e4==t.errcode&&(e.ifgetcode=!0,e.countimer=t.data.second,e.counttime(t.data.second))}):(this.$refs.mobile.forceShowError=!0,this.$vux.toast.text("请输入正确的手机号"))},login:function(){var e=this;this.$refs.mobile.validate(),this.$refs.verifycode.validate(),this.form.mobile_code=parseInt(this.mobile_code),this.$refs.mobile.valid&&this.$refs.verifycode.valid?this.$http.post("/api/app.user/user/login",this.form).then(function(t){"0"==t.errcode&&(e.setToken(t.data._user_token),localStorage.setItem("token",o()(t.data._user_token)),e.$router.push({path:"/mine/center"}))}).catch(function(t){"50001"==t.errcode?e.step=2:e.$vux.toast.text(t.message)}):(this.$refs.mobile.forceShowError=!0,this.$refs.verifycode.forceShowError=!0)},register:function(){var e=this;this.$refs.username.validate(),this.$refs.password.validate(),this.$refs.check_password.validate(),this.form.mobile_code=parseInt(this.mobile_code),this.$refs.username.valid&&this.$refs.password.valid&&this.$refs.check_password.valid?this.$http.post("/api/app.user/user/register",this.form).then(function(t){"0"==t.errcode&&(e.setToken(t.data._user_token),localStorage.setItem("token",o()(t.data._user_token)),e.$router.push({path:"/mine/center"}))}).catch(function(t){t.errcode&&e.$vux.toast.text(t.message),50010==t.errcode&&(e.step=1)}):(this.$refs.username.forceShowError=!0,this.$refs.password.forceShowError=!0,this.$refs.check_password.forceShowError=!0,this.form.check_password||(this.$refs.check_password.errors.equal="输入不一致",this.$refs.check_password.getError()))},loginForPwd:function(){var e=this;this.$refs.username.validate(),this.$refs.password.validate(),this.$refs.username.valid&&this.$refs.password.valid?this.$http.post("/api/app.user/user/loginForPwd",this.form).then(function(t){"0"==t.errcode&&(e.setToken(t.data._user_token),localStorage.setItem("token",o()(t.data._user_token)),e.$router.push({path:"/mine/center"}))}).catch(function(t){"50001"==t.errcode?e.$vux.toast.text("您还未注册，请使用短信登录完成注册"):e.$vux.toast.text(t.message)}):(this.$refs.username.forceShowError=!0,this.$refs.password.forceShowError=!0)},backlogin:function(){this.step=1},toResetPwd:function(){this.$router.push({path:"/login/pwdreset"})},counttime:function(e){var t=this;this.wait||(this.countimer=e,this.ifgetcode=!0,this.wait=setInterval(function(){t.countimer>0&&t.countimer<=e?t.countimer--:(t.ifgetcode=!1,clearInterval(t.wait),t.wait=null)},1e3))},endtimer:function(){this.$vux.toast.text("请于倒计时结束后再获取验证码")},switchStatus:function(e){this.loginType=e}}),{components:{Flexbox:n.a,FlexboxItem:c.a,Divider:l.a,Drawer:p.a,Tab:d.a,TabItem:u.a,PopupPicker:f.a},data:function(){return{step:1,countimer:"",ifgetcode:!1,wait:null,form:{mobile:"",verifycode:"",username:"",password:"",check_password:"",mobile_code:86},loginType:"pwdLogin",mobile_code:["+86"],code_list:[]}},mounted:function(){var e=this;this.$http.post("api/app.util/init/get_mobile_code",{}).then(function(t){e.code_list=t.data.code_list})},methods:a()({},Object(h.b)(["setToken"]),{getCode:function(){var e=this;this.$refs.mobile.validate(),this.$refs.mobile.valid&&""!=this.form.mobile?this.$http.post("/api/app.util/sms/send",{mobile:this.form.mobile,type:0,mobile_code:parseInt(this.mobile_code)}).then(function(t){e.$vux.toast.text("发送成功"),e.$vux.toast.text(t.message),e.counttime(60)}).catch(function(t){e.$vux.toast.text(t.message),1e4==t.errcode&&(e.ifgetcode=!0,e.countimer=t.data.second,e.counttime(t.data.second))}):(this.$refs.mobile.forceShowError=!0,this.$vux.toast.text("请输入正确的手机号"))},login:function(){var e=this;this.$refs.mobile.validate(),this.$refs.verifycode.validate(),this.form.mobile_code=parseInt(this.mobile_code),this.$refs.mobile.valid&&this.$refs.verifycode.valid?this.$http.post("/api/app.user/user/login",this.form).then(function(t){"0"==t.errcode&&(e.setToken(t.data._user_token),localStorage.setItem("token",o()(t.data._user_token)),e.$router.push({path:"/mine/center"}))}).catch(function(t){"50001"==t.errcode?e.step=2:e.$vux.toast.text(t.message)}):(this.$refs.mobile.forceShowError=!0,this.$refs.verifycode.forceShowError=!0)},register:function(){var e=this;this.$refs.username.validate(),this.$refs.password.validate(),this.$refs.check_password.validate(),this.form.mobile_code=parseInt(this.mobile_code),this.$refs.username.valid&&this.$refs.password.valid&&this.$refs.check_password.valid?this.$http.post("/api/app.user/user/register",this.form).then(function(t){"0"==t.errcode&&(e.setToken(t.data._user_token),localStorage.setItem("token",o()(t.data._user_token)),e.$router.push({path:"/mine/center"}))}).catch(function(t){t.errcode&&e.$vux.toast.text(t.message),50010==t.errcode&&(e.step=1)}):(this.$refs.username.forceShowError=!0,this.$refs.password.forceShowError=!0,this.$refs.check_password.forceShowError=!0,this.form.check_password||(this.$refs.check_password.errors.equal="输入不一致",this.$refs.check_password.getError()))},loginForPwd:function(){var e=this;this.$refs.username.validate(),this.$refs.password.validate(),this.$refs.username.valid&&this.$refs.password.valid?this.$http.post("/api/app.user/user/loginForPwd",this.form).then(function(t){"0"==t.errcode&&(e.setToken(t.data._user_token),localStorage.setItem("token",o()(t.data._user_token)),e.$router.push({path:"/mine/center"}))}).catch(function(t){"50001"==t.errcode?e.$vux.toast.text("您还未注册，请使用短信登录完成注册"):e.$vux.toast.text(t.message)}):(this.$refs.username.forceShowError=!0,this.$refs.password.forceShowError=!0)},backlogin:function(){this.step=1},toResetPwd:function(){this.$router.push({path:"/login/pwdreset"})},counttime:function(e){var t=this;this.wait||(this.countimer=e,this.ifgetcode=!0,this.wait=setInterval(function(){t.countimer>0&&t.countimer<=e?t.countimer--:(t.ifgetcode=!1,clearInterval(t.wait),t.wait=null)},1e3))},endtimer:function(){this.$vux.toast.text("请于倒计时结束后再获取验证码")},switchStatus:function(e){this.loginType=e}})}),v={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page-login"},[r("tab",{attrs:{"line-width":2,"custom-bar-width":"60px"}},[r("tab-item",{nativeOn:{click:function(t){e.switchStatus("smsLogin")}}},[e._v("短信登录")]),e._v(" "),r("tab-item",{attrs:{selected:""},nativeOn:{click:function(t){e.switchStatus("pwdLogin")}}},[e._v("密码登录")])],1),e._v(" "),"smsLogin"==e.loginType?r("div",[1==e.step?r("div",{},[r("div",{staticClass:"clear"}),e._v(" "),r("group",[r("div",{staticClass:"login-mobile flex-box"},[r("popup-picker",{ref:"picker",attrs:{title:"",data:e.code_list,columns:3},model:{value:e.mobile_code,callback:function(t){e.mobile_code=t},expression:"mobile_code"}}),e._v(" "),r("x-input",{ref:"mobile",staticClass:"mobile-input flex-1",attrs:{title:"",name:"mobile",placeholder:"请输入手机号码",type:"number",keyboard:"number",required:!0},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),r("x-input",{ref:"verifycode",staticClass:"weui-vcode vux-1px-b",attrs:{placeholder:"请输入验证码",type:"number",keyboard:"number",min:6,required:!0},model:{value:e.form.verifycode,callback:function(t){e.$set(e.form,"verifycode",t)},expression:"form.verifycode"}},[e.ifgetcode?e._e():r("x-button",{attrs:{slot:"right",plain:"",type:"primary",mini:""},nativeOn:{click:function(t){e.getCode()}},slot:"right"},[e._v("发送验证码")]),e._v(" "),e.ifgetcode?r("x-button",{attrs:{slot:"right",plain:"",type:"primary",mini:""},nativeOn:{click:function(t){e.endtimer()}},slot:"right"},[e._v("重新发送"+e._s(e.countimer)+"s'")]):e._e()],1)],1),e._v(" "),r("box",{attrs:{gap:"40px 10px"}},[r("x-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.login()}}},[e._v("登录")])],1)],1):e._e(),e._v(" "),2==e.step?r("div",{},[r("flexbox",{staticClass:"l-tit",attrs:{orient:"vertical",justify:"center"}},[r("div",{staticClass:"user-portrait"},[r("img",{attrs:{src:s("0gU3"),alt:""}})]),e._v(" "),r("div",{staticClass:"modeil"},[e._v(e._s(e.form.mobile))])]),e._v(" "),r("group",[r("x-input",{ref:"username",attrs:{title:"用户名",name:"username",placeholder:"请输入用户名",required:!0},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),e._v(" "),r("x-input",{ref:"password",attrs:{type:"password",title:"密码",name:"password",placeholder:"请输入密码",min:6,max:16,required:!0},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),e._v(" "),r("x-input",{ref:"check_password",attrs:{type:"password",title:"确认密码",name:"check_password",placeholder:"请输入确认密码",min:6,max:16,"equal-with":e.form.password,required:!0},model:{value:e.form.check_password,callback:function(t){e.$set(e.form,"check_password",t)},expression:"form.check_password"}}),e._v(" "),r("x-input",{attrs:{title:"邀请码",name:"invite_code",placeholder:"请输入邀请码（选填）"},model:{value:e.form.invite_code,callback:function(t){e.$set(e.form,"invite_code",t)},expression:"form.invite_code"}})],1),e._v(" "),r("box",{attrs:{gap:"30px 10px 20px"}},[r("x-button",{staticStyle:{"border-radius":"99px"},attrs:{type:"primary"},nativeOn:{click:function(t){e.register()}}},[e._v("完成")])],1),e._v(" "),r("div",{staticClass:"backlogin",staticStyle:{"text-align":"center"},on:{click:function(t){e.backlogin()}}},[e._v("\r\n                返回登录页\r\n            ")])],1):e._e()]):e._e(),e._v(" "),"pwdLogin"==e.loginType?r("div",[r("div",{staticClass:"clear"}),e._v(" "),r("group",[r("x-input",{ref:"username",attrs:{title:"账号",name:"username",placeholder:"用户名/手机号",type:"text",required:!0},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),e._v(" "),r("x-input",{ref:"password",staticClass:"input-possword vux-1px-b",attrs:{type:"password",title:"密码",name:"password",placeholder:"请输入密码",required:!0},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),r("box",{attrs:{gap:"40px 10px 20px"}},[r("x-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.loginForPwd()}}},[e._v("登录")])],1),e._v(" "),r("div",{staticClass:"backlogin",staticStyle:{"text-align":"center"},on:{click:function(t){e.toResetPwd()}}},[e._v("\r\n            找回密码\r\n        ")])],1):e._e()],1)},staticRenderFns:[]};var _=s("C7Lr")(m,v,!1,function(e){s("ABmE")},null,null);t.default=_.exports},"sm+P":function(e,t,s){var r={"./views/login/index":"T+/8"};function o(e){return s(i(e))}function i(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id="sm+P"}});