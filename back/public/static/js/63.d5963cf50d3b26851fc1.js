webpackJsonp([63],{HASe:function(t,e,a){var i={"./views/user/setwechat":"VlMg"};function n(t){return a(s(t))}function s(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}n.keys=function(){return Object.keys(i)},n.resolve=s,t.exports=n,n.id="HASe"},VlMg:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("dZLx"),n=a("Wf59"),s=(n.a,{components:{"vue-core-image-upload":n.a},data:function(){return{hasWallet:0,payment_receipt:"",payment_account:"",security:"",qrcode:"",uploadUrl:"/api/app.util/upload",params:{type:"weixin",_user_token:this.$store.state.token}}},mounted:function(){this.getPaymentInfo();var t=this;window.CutCallBack=function(e){t.CutCallBack(e)}},methods:{getPaymentInfo:function(){var t=this;this.$http.post("/api/app.payment/payment/bindinfo",{payment_key:"weixin"}).then(function(e){e.data.bind_info.weixin&&(t.payment_receipt=e.data.bind_info.weixin.payment_receipt,t.payment_account=e.data.bind_info.weixin.payment_account,t.qrcode=e.data.bind_info.weixin.qrcode)}).catch(function(e){e.errcode&&t.$vux.toast.text(e.message)})},bindPayment:function(){var t=this;""!=this.qrcode?""!=this.payment_receipt?""!=this.payment_account?""!=this.security?this.$http.post("/api/app.payment/payment/bind",{payment_key:"weixin",qrcode:this.qrcode,payment_receipt:this.payment_receipt,payment_account:this.payment_account,security:Object(i.a)(this.security)}).then(function(e){"0"==e.errcode&&(t.$vux.toast.show({text:"绑定成功"}),t.$router.push({path:"/user/setpay"}))}).catch(function(e){e.errcode&&t.$vux.toast.text(e.message)}):this.$vux.toast.text("请输入资产密码"):this.$vux.toast.text("请填写账号"):this.$vux.toast.text("请填写姓名"):this.$vux.toast.text("请上传二维码图片")},imageuploaded:function(t){0==t.errcode&&(this.qrcode=t.data.file_url)},AppUpload:function(){App.CutPhoto('{"w":"200","h":"200"}')},CutCallBack:function(t){var e=this,a=new FormData;a.append("type","weixin"),a.append("file",convertBase64UrlToBlob(t));this.$http.post("/api/app.util/upload",a,{header:{"Content-Type":"multipart/form-data"}}).then(function(t){0==t.errcode&&(e.qrcode=t.data.file_url)})}}}),o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"setalipay"},[a("div",{staticClass:"setalipay-box"},[a("div",{staticClass:"setalipay-top"},[a("div",{staticClass:"update-box flex-box"},[""==t.qrcode?a("div",{staticClass:"iconfont"},[t._v("")]):t._e(),t._v(" "),""==t.qrcode?a("div",{staticClass:"setalipay-top-text"},[t._v("\r\n                    上传您的微信支付二维码\r\n                ")]):a("img",{staticClass:"qrcode-img",attrs:{src:t.qrcode}})]),t._v(" "),t.$store.state.init.is_app?a("div",{staticClass:"upload-btn",on:{click:t.AppUpload}}):a("div",{staticClass:"upload-btn"},[a("vue-core-image-upload",{staticClass:"btn btn-primary",attrs:{crop:!1,data:t.params,"max-file-size":5242880,inputOfFile:"file",url:t.uploadUrl,text:""},on:{imageuploaded:t.imageuploaded}})],1)]),t._v(" "),a("div",{staticClass:"block"},[a("group",{staticClass:"alipay-item no-line"},[a("x-input",{attrs:{title:"姓名","text-align":"right",max:10},model:{value:t.payment_receipt,callback:function(e){t.payment_receipt=e},expression:"payment_receipt"}})],1)],1),t._v(" "),a("div",{staticClass:"block"},[a("group",{staticClass:"alipay-item"},[a("x-input",{attrs:{title:"微信账户","text-align":"right",placeholder:"请输入您的微信账户",max:20},model:{value:t.payment_account,callback:function(e){t.payment_account=e},expression:"payment_account"}})],1)],1),t._v(" "),a("div",{staticClass:"block"},[a("group",{staticClass:"alipay-item no-line"},[a("x-input",{attrs:{type:"password",title:"资产密码","text-align":"right",placeholder:"请输入您的资产密码"},model:{value:t.security,callback:function(e){t.security=e},expression:"security"}})],1)],1),t._v(" "),a("div",{staticClass:"reset-btn-box"},[a("box",{attrs:{gap:"30px 35px"}},[a("x-button",{staticClass:"found-btn",staticStyle:{"border-radius":"99px"},attrs:{type:"primary"},nativeOn:{click:function(e){t.bindPayment()}}},[t._v("保存")])],1)],1)])])},staticRenderFns:[]};var c=a("C7Lr")(s,o,!1,function(t){a("eL6U")},null,null);e.default=c.exports},eL6U:function(t,e){}});