webpackJsonp([44],{"5PO4":function(e,t,o){var r={"./views/user/security":"WBYW"};function s(e){return o(i(e))}function i(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}s.keys=function(){return Object.keys(r)},s.resolve=i,e.exports=s,s.id="5PO4"},ELLo:function(e,t){},WBYW:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={components:{},data:function(){return{form:{verifycode:"",mobile:null,password:"",check_password:""},ifgetcode:!1,countimer:""}},mounted:function(){this.getUserinfo()},methods:{getUserinfo:function(){var e=this;this.$http.post("/api/app.user/account/info",{}).then(function(t){e.form.mobile=t.data.account_info.mobile,e.mobile_code=t.data.account_info.mobile_code}).catch(function(t){t.errcode&&e.$vux.toast.text(t.message)})},getCode:function(){var e=this;""!=this.form.mobile?this.$http.post("/api/app.util/sms/send",{mobile:this.form.mobile,type:0,mobile_code:this.mobile_code}).then(function(t){e.$vux.toast.text("发送成功"),e.$vux.toast.text(t.message),e.counttime(60)}).catch(function(t){e.$vux.toast.text(t.message),1e4==t.errcode&&(e.ifgetcode=!0,e.countimer=t.data.second,e.counttime(t.data.second))}):this.$vux.toast.text("请输入正确的手机号")},resetPwd:function(){var e=this;this.$refs.verifycode.validate(),this.$refs.password.validate(),this.$refs.check_password.validate(),this.$refs.verifycode.valid&&this.$refs.password.valid&&this.$refs.check_password.valid?this.$http.post("/api/app.user/account/security",this.form).then(function(t){"0"==t.errcode&&(e.$vux.toast.text("重置成功"),e.$router.go(-1))}).catch(function(t){e.$vux.toast.text(t.message)}):(this.$refs.verifycode.forceShowError=!0,this.$refs.password.forceShowError=!0,this.$refs.check_password.forceShowError=!0,this.form.check_password||(this.$refs.check_password.errors.equal="输入不一致",this.$refs.check_password.getError()))},backlogin:function(){this.$router.push({path:"/login"})},counttime:function(e){var t=this;this.wait||(this.countimer=e,this.ifgetcode=!0,this.wait=setInterval(function(){t.countimer>0&&t.countimer<=e?t.countimer--:(t.ifgetcode=!1,clearInterval(t.wait),t.wait=null)},1e3))},endtimer:function(){this.$vux.toast.text("请于倒计时结束后再获取验证码")}}},s={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"show",rawName:"v-show",value:null!=e.form.mobile,expression:"form.mobile!=null"}],staticClass:"security"},[o("group",[o("x-input",{ref:"verifycode",staticClass:"weui-vcode",attrs:{type:"number",keyboard:"number",placeholder:"请输入验证码",min:6,required:!0},model:{value:e.form.verifycode,callback:function(t){e.$set(e.form,"verifycode",t)},expression:"form.verifycode"}},[e.ifgetcode?e._e():o("x-button",{attrs:{slot:"right",plain:"",type:"primary",mini:""},nativeOn:{click:function(t){e.getCode()}},slot:"right"},[e._v("发送验证码")]),e._v(" "),e.ifgetcode?o("x-button",{attrs:{slot:"right",plain:"",type:"primary",mini:""},nativeOn:{click:function(t){e.endtimer()}},slot:"right"},[e._v("重新发送"+e._s(e.countimer)+"s'")]):e._e()],1)],1),e._v(" "),o("group",[o("x-input",{ref:"password",attrs:{type:"password",title:"新的密码",name:"password",placeholder:"请输入密码",min:6,max:16,required:!0},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),e._v(" "),o("x-input",{ref:"check_password",attrs:{type:"password",title:"确认密码",name:"check_password",placeholder:"请输入密码",min:6,max:16,"equal-with":e.form.password,required:!0},model:{value:e.form.check_password,callback:function(t){e.$set(e.form,"check_password",t)},expression:"form.check_password"}})],1),e._v(" "),o("box",{attrs:{gap:"20px 20px"}},[o("x-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.resetPwd(t)}}},[e._v("确认设置")])],1)],1)},staticRenderFns:[]};var i=o("C7Lr")(r,s,!1,function(e){o("ELLo")},null,null);t.default=i.exports}});